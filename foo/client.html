<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <title>Squars.LI7E</title>
    <meta http-equiv="Content-type" content="text/html; charset=UTF-8" />
    <meta name="description" content="LI7E!" />

    <link rel="stylesheet" type="text/css" href="style/squars.css" />
    <link rel="stylesheet" type="text/css" href="style/style.css" />

    <script type="text/javascript" src="/socket.io/socket.io.js"></script>
    <script type="text/javascript" src="js/jquery-1.6.1.min.js"></script>
    <script type="text/javascript" src="js/Audiolet.min.js"></script>
    <script type="text/javascript" src="js/squars.js"></script>
    <!-- <script type="text/javascript" src="js/client.js"></script> --> 
    
    
       <script  type="text/javascript">
	 function message(obj){
	 var el = document.createElement('p');
	 console.log(obj.message);
	 console.log("escrevendo mensagem...");				
	 el.innerHTML = '<b>' + (obj.message[0]) + ':</b> ' + (obj.message[1]);
	 document.getElementById('chat').appendChild(el);
	 document.getElementById('chat').scrollTop = 1000000;
	 };

	 function send(){
	 var val = document.getElementById('textit').value;
	 console.log("enviando mensagem...");
	 socket.emit('message',{ my: ['you',val]});
	 message({ message: ['you', val] });
	 document.getElementById('textit').value = "";
	 };

	 var socket = io.connect('http://localhost:8080/');
	 console.log('Client connected');
	 socket.on('message', function(obj){
	 console.log(obj);
	 if ('buffer' in obj){
	 document.getElementById('form').style.display='block';
	 document.getElementById('chat').innerHTML = '';

	 for (var i in obj.buffer) 
	 message(obj.buffer[i]);
	 } else 
	 message(obj);
	 });
       </script> 
       
  </head>
  <body style="cursor: auto;">
    
    <div id="box" >
      <div style="float:left;">
	<input onclick="play();" value="Play" type="button" />&nbsp;
	<input onclick="stop();" value="Stop" type="button" />&nbsp;<br /> <br />
	<input onclick="clearClicks();" value="Clear All" type="button" />&nbsp;<br /> <br />
	<div id="jdebug">Debug</div>
	<br /><br />
      </div>
      <canvas style="float:right;" id="squars" width="450" height="450"></canvas>
    </div> 
    <div id="divChat">
      <div id="chat"></div>
      <form id="form" onsubmit="send(); return false">
	<input type="text" autocomplete="off" id="textit" />
	<input type="submit" value="Send" />
      </form>
    </div> 
  </body>
</html>
